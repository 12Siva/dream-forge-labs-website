<!DOCTYPE html>
<html lang="en" class="scroll-smooth h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoomEd App - Read & Annotate</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
             plugins: [
                require('@tailwindcss/typography'), // Ensure typography plugin is enabled
             ],
            theme: {
                extend: {
                    colors: {
                        'deep-purple': '#6B4FBF',
                        'warm-cream': '#FFF8E7',
                        'coral-pink': '#FF7B68',
                        'ocean-teal': '#2DBFB8',
                        'golden-yellow': '#FFB84D',
                        'forest-green': '#4A7C59',
                        'slate-gray': '#6B7280',
                        'soft-red': '#E86C6C',
                        'charcoal': '#2D3748',
                        'medium-purple': '#8B7AB8',
                         // UI specific adjustments
                        'sidebar-bg': '#FFF8E7', // warm-cream
                        'sidebar-bg-dark': '#2D3748', // charcoal
                        'sidebar-border': '#E0D8F5', // Lighter purple
                        'sidebar-border-dark': '#4A3B7E', // Darker purple
                        'reading-bg': '#FFFFFF',
                        'reading-bg-dark': '#1F2937', // Gray-800, slightly lighter than charcoal
                        'highlight-bg': '#FFF3C4', // Lighter yellow
                        'highlight-bg-dark': '#A092D8', // Lighter medium-purple
                        'accent': '#2DBFB8', // ocean-teal
                        'accent-dark': '#FFB84D', // golden-yellow
                    },
                    fontFamily: {
                        display: ['Fredoka', 'sans-serif'],
                        body: ['Lexend', 'sans-serif'],
                        ui: ['Inter', 'sans-serif'],
                    },
                     animation: {
                        'fade-in': 'fadeIn 0.5s ease-out forwards',
                        'spin-slow': 'spin 2s linear infinite',
                     },
                     keyframes: {
                        fadeIn: {
                            '0%': { opacity: 0, transform: 'translateY(10px)' },
                            '100%': { opacity: 1, transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@500;600&family=Inter:wght@400;500&family=Lexend:wght@400&display=swap" rel="stylesheet">
    <style>
        html, body {
            height: 100%;
            overflow: hidden; /* Prevent scrolling on the body */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: theme('colors.warm-cream');
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s ease;
        }
        .dark body {
            background-color: theme('colors.charcoal');
        }
        ::selection {
            background-color: theme('colors.golden-yellow');
            color: theme('colors.charcoal');
        }
        .dark ::selection {
             background-color: theme('colors.ocean-teal');
             color: theme('colors.warm-cream');
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: theme('colors.gray.200'); border-radius: 4px; }
        .dark ::-webkit-scrollbar-track { background: theme('colors.gray.700'); }
        ::-webkit-scrollbar-thumb { background: theme('colors.gray.400'); border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb { background: theme('colors.gray.500'); }
        ::-webkit-scrollbar-thumb:hover { background: theme('colors.gray.500'); }
        .dark ::-webkit-scrollbar-thumb:hover { background: theme('colors.gray.400'); }

        /* Highlight style */
        .highlight {
            background-color: theme('colors.highlight-bg');
            border-radius: 3px;
            padding: 0 0.1em; /* Add slight padding */
            margin: 0 -0.1em; /* Counteract padding */
        }
        .dark .highlight {
             background-color: theme('colors.highlight-bg-dark');
             color: theme('colors.warm-cream');
        }

        /* Pop-up menu style */
        #highlight-menu {
            position: absolute;
            display: none;
            background-color: theme('colors.charcoal');
            color: theme('colors.warm-cream');
            border-radius: 8px; /* Softer corners */
            padding: 6px 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 100;
            opacity: 0;
            transform: translateY(5px);
            transition: opacity 0.2s ease, transform 0.2s ease;
        }
        .dark #highlight-menu {
             background-color: theme('colors.warm-cream');
             color: theme('colors.charcoal');
        }
        #highlight-menu.visible {
            opacity: 1;
            transform: translateY(0);
            display: block; /* Ensure it's visible when class is added */
        }
        #highlight-menu button {
            background: none;
            border: none;
            color: inherit;
            padding: 6px 10px;
            margin: 0 3px;
            cursor: pointer;
            border-radius: 6px;
            font-size: 0.9em;
            transition: background-color 0.2s ease;
        }
         #highlight-menu button:hover {
             background-color: theme('colors.medium-purple');
         }
         .dark #highlight-menu button:hover {
             background-color: theme('colors.golden-yellow');
         }
         /* Style the selected story button */
        #story-list button.selected {
             background-color: theme('colors.medium-purple/30');
             font-weight: 600; /* Semibold */
             color: theme('colors.deep-purple');
        }
        .dark #story-list button.selected {
            background-color: theme('colors.deep-purple/50');
            color: theme('colors.warm-cream');
        }

    </style>
     <script>
        // Set theme on initial load to prevent FOUC and default to light mode
        if (localStorage.getItem('theme') === 'dark') {
          document.documentElement.classList.add('dark');
        } else {
          document.documentElement.classList.remove('dark');
        }
    </script>
</head>
<body class="antialiased font-ui text-charcoal dark:text-warm-cream">

    <!-- Header -->
    <header class="bg-warm-cream/90 dark:bg-charcoal/90 backdrop-blur-sm sticky top-0 z-50 border-b border-sidebar-border dark:border-sidebar-border-dark flex-shrink-0 shadow-sm">
        <div class="container mx-auto px-6 py-3"> {/* Reduced padding slightly */}
            <nav class="flex items-center justify-between">
                <a href="../index.html" class="text-xl md:text-2xl font-display font-semibold text-deep-purple dark:text-warm-cream flex items-center transition-opacity hover:opacity-80">
                    <i class="fas fa-book-reader mr-2 text-deep-purple"></i> LoomEd Reader
                </a>
                <div class="flex items-center space-x-3 md:space-x-4">
                    {/* Display title centered and truncated */}
                     <span id="current-story-title" class="flex-1 text-center text-base md:text-lg font-medium text-charcoal dark:text-warm-cream truncate px-4 hidden sm:block">No Story Selected</span>
                    <button id="theme-toggle" title="Toggle Theme" class="text-medium-purple dark:text-warm-cream hover:text-deep-purple dark:hover:text-golden-yellow transition-colors w-9 h-9 md:w-10 md:h-10 flex items-center justify-center rounded-full hover:bg-medium-purple/10 dark:hover:bg-deep-purple/20">
                        <i class="fas fa-moon text-lg md:text-xl hidden" id="theme-toggle-dark-icon"></i>
                        <i class="fas fa-sun text-lg md:text-xl hidden" id="theme-toggle-light-icon"></i>
                    </button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content Area (Sidebar + Reading Pane) -->
    <div class="flex flex-1 overflow-hidden">
        <!-- Sidebar -->
        <aside id="story-list-container" class="w-56 md:w-64 bg-sidebar-bg dark:bg-sidebar-bg-dark border-r border-sidebar-border dark:border-sidebar-border-dark p-3 md:p-4 overflow-y-auto flex-shrink-0 transition-colors duration-300 ease-in-out">
            <h2 class="text-base md:text-lg font-semibold mb-3 md:mb-4 text-deep-purple dark:text-warm-cream px-1">Available Stories</h2>
             {/* Simple Skeleton Loader */}
             <div id="story-list-loading" class="space-y-3 animate-pulse">
                 <div class="h-8 bg-gray-300 dark:bg-gray-600 rounded-md"></div>
                 <div class="h-8 bg-gray-300 dark:bg-gray-600 rounded-md w-5/6"></div>
                 <div class="h-8 bg-gray-300 dark:bg-gray-600 rounded-md w-3/4"></div>
             </div>
             <div id="story-list-error" class="hidden text-center py-4 px-2 bg-soft-red/10 dark:bg-soft-red/20 rounded-lg border border-soft-red/30">
                 <i class="fas fa-cloud-showers-heavy text-3xl text-soft-red mb-3"></i>
                 <p class="text-sm text-soft-red font-medium mb-3">Oops! Couldn't load stories.</p>
                 <button id="retry-load-stories" class="px-3 py-1 bg-deep-purple text-warm-cream text-xs font-semibold rounded-md hover:bg-opacity-80 transition-colors shadow-sm">Retry</button>
             </div>
            <ul id="story-list" class="space-y-1">
                <!-- Story items will be dynamically inserted here -->
            </ul>
        </aside>

        <!-- Reading Pane -->
        <main id="reading-pane" class="flex-1 p-6 md:p-10 lg:p-12 overflow-y-auto bg-reading-bg dark:bg-reading-bg-dark transition-colors duration-300 ease-in-out">
            <div id="story-content-loading" class="hidden text-center py-10 flex flex-col items-center justify-center text-slate-gray dark:text-gray-400">
                <i class="fas fa-spinner fa-spin text-4xl text-accent dark:text-accent-dark animate-spin-slow"></i>
                <p class="mt-4 text-lg">Loading story...</p>
            </div>
             <div id="story-content-error" class="hidden text-center py-10 px-4 bg-soft-red/10 dark:bg-soft-red/20 rounded-lg border border-soft-red/30">
                 <i class="fas fa-heart-broken text-4xl text-soft-red mb-4"></i>
                 <p class="text-lg text-soft-red font-medium mb-4">Oh no! Something went wrong loading the story.</p>
                  <p id="story-content-error-message" class="text-sm text-soft-red/80 mb-5"></p>
                  <button id="retry-load-content" class="px-4 py-2 bg-deep-purple text-warm-cream text-sm font-semibold rounded-md hover:bg-opacity-80 transition-colors shadow-sm">Try Loading Again</button>
             </div>
             <div id="welcome-message" class="text-center py-20 px-6 flex flex-col items-center justify-center h-full">
                 <i class="fas fa-book-open text-6xl text-golden-yellow mb-6 animate-pulse"></i>
                 <h2 class="text-2xl md:text-3xl font-display font-semibold text-deep-purple dark:text-warm-cream mb-3">Welcome to LoomEd!</h2>
                 <p class="text-base md:text-lg text-charcoal dark:text-gray-300 max-w-md">Ready for an adventure? Pick a story from the sidebar on the left to begin reading.</p>
             </div>
            {/* Added animate-fade-in for content loading */}
            <article id="story-content" class="prose prose-lg lg:prose-xl dark:prose-invert max-w-none text-charcoal dark:text-gray-200 opacity-0">
                {/* Story text will be dynamically inserted here */}
            </article>
        </main>
    </div>

    <!-- Highlight Pop-up Menu -->
    <div id="highlight-menu">
        <button id="highlight-button" title="Highlight Selection"><i class="fas fa-highlighter"></i></button>
        {/* <button id="note-button"><i class="fas fa-sticky-note mr-1"></i> Add Note</button> */}
    </div>


    <script>
        // --- Configuration ---
        // !!! IMPORTANT: Replace this placeholder with your actual API Gateway Invoke URL !!!
        const API_BASE_URL = 'https://dgv9q2uuuf.execute-api.us-east-2.amazonaws.com/Prod/stories'; // e.g., 'https://dgy9q2uuuf.execute-api.us-east-2.amazonaws.com/Prod'

        // --- DOM Elements ---
        const storyListContainer = document.getElementById('story-list');
        const storyListLoading = document.getElementById('story-list-loading');
        const storyListError = document.getElementById('story-list-error');
        const retryLoadStoriesBtn = document.getElementById('retry-load-stories');

        const readingPane = document.getElementById('reading-pane');
        const storyContentContainer = document.getElementById('story-content');
        const storyContentLoading = document.getElementById('story-content-loading');
        const storyContentError = document.getElementById('story-content-error');
        const storyContentErrorMessage = document.getElementById('story-content-error-message');
        const retryLoadContentBtn = document.getElementById('retry-load-content');
        const welcomeMessage = document.getElementById('welcome-message');
        const currentStoryTitleHeader = document.getElementById('current-story-title');

        const highlightMenu = document.getElementById('highlight-menu');
        const highlightButton = document.getElementById('highlight-button');
        // const noteButton = document.getElementById('note-button'); // For future use

        let currentSelection = null; // Store the current text selection range
        let lastLoadedStoryId = null; // Remember the last story attempted to load

        // --- API Functions ---
        async function fetchStoryList() {
            showStoryListLoading(true);
            showStoryListError(false);
            try {
                if (!API_BASE_URL || API_BASE_URL === 'YOUR_API_GATEWAY_INVOKE_URL') {
                    throw new Error("API URL not configured. Please update the API_BASE_URL variable.");
                }
                const response = await fetch(`${API_BASE_URL}/stories`);
                if (!response.ok) {
                    throw new Error(`Network response was not ok (${response.status})`);
                }
                const stories = await response.json();
                populateStoryList(stories);
            } catch (error) {
                console.error('Error fetching story list:', error);
                showStoryListError(true, `Failed to load stories. ${error.message}`);
            } finally {
                showStoryListLoading(false);
            }
        }

        async function fetchStoryContent(storyId) {
            showStoryContentLoading(true);
            showStoryContentError(false);
            welcomeMessage.classList.add('hidden');
            storyContentContainer.innerHTML = ''; // Clear previous content
            storyContentContainer.classList.remove('animate-fade-in'); // Reset animation
             storyContentContainer.style.opacity = 0; // Hide for fade-in
            currentStoryTitleHeader.textContent = 'Loading...'; // Placeholder title
            lastLoadedStoryId = storyId; // Store the ID we're trying to load

            try {
                 if (!API_BASE_URL || API_BASE_URL === 'YOUR_API_GATEWAY_INVOKE_URL') {
                    throw new Error("API URL not configured. Please update the API_BASE_URL variable.");
                 }
                const response = await fetch(`${API_BASE_URL}/story?id=${encodeURIComponent(storyId)}`);
                if (!response.ok) {
                    throw new Error(`Network response was not ok (${response.status})`);
                }
                const storyData = await response.json();
                displayStoryContent(storyData);
            } catch (error) {
                console.error('Error fetching story content:', error);
                showStoryContentError(true, `Failed to load story content. ${error.message}`);
                 currentStoryTitleHeader.textContent = 'Error Loading Story';
            } finally {
                showStoryContentLoading(false);
            }
        }

        // --- UI Update Functions ---
        function showStoryListLoading(isLoading) {
             storyListLoading.style.display = isLoading ? 'block' : 'none';
        }

         function showStoryListError(isError, message = "Could not load stories.") {
            storyListError.classList.toggle('hidden', !isError);
             if(isError) {
                 const errMsgElement = storyListError.querySelector('p');
                 errMsgElement.textContent = message;
             }
        }

        function showStoryContentLoading(isLoading) {
            storyContentLoading.style.display = isLoading ? 'flex' : 'none'; // Use flex for centering
            if(isLoading) {
                storyContentContainer.classList.add('hidden'); // Hide content area while loading
                 welcomeMessage.classList.add('hidden');
                 storyContentError.classList.add('hidden'); // Ensure error is hidden
            } else {
                 // Content visibility handled by displayStoryContent
            }
        }

        function showStoryContentError(isError, message = "Could not load the story content.") {
            storyContentError.classList.toggle('hidden', !isError);
             if(isError) {
                 storyContentErrorMessage.textContent = message;
                 welcomeMessage.classList.add('hidden');
                 storyContentContainer.classList.add('hidden'); // Hide content area on error
                 storyContentLoading.style.display = 'none'; // Ensure loading is hidden
             }
        }

        function formatTitle(title) {
            return title
                .replace(/\.(pdf|txt)$/i, '') // Remove extension
                .replace(/_/g, ' ') // Replace underscores
                .split(' ')
                .map(word => word.charAt(0).toUpperCase() + word.slice(1)) // Capitalize words
                .join(' ');
        }

        function populateStoryList(stories) {
            storyListContainer.innerHTML = ''; // Clear previous list
            if (!stories || stories.length === 0) {
                 storyListContainer.innerHTML = '<li class="text-sm text-slate-gray dark:text-gray-400 px-2 py-1 italic">No stories found in bucket.</li>';
                 return;
            }

            stories.forEach(story => {
                const li = document.createElement('li');
                const button = document.createElement('button');
                button.textContent = formatTitle(story.title); // Use formatted title
                button.dataset.storyId = story.id;
                button.className = 'w-full text-left px-3 py-1.5 rounded-md text-sm text-charcoal dark:text-warm-cream hover:bg-medium-purple/20 dark:hover:bg-deep-purple/30 transition-colors duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-deep-purple dark:focus:ring-medium-purple focus:ring-offset-2 dark:focus:ring-offset-charcoal';
                button.addEventListener('click', () => {
                     document.querySelectorAll('#story-list button').forEach(btn => btn.classList.remove('selected'));
                     button.classList.add('selected');
                    fetchStoryContent(story.id);
                });
                li.appendChild(button);
                storyListContainer.appendChild(li);
            });
        }

        function displayStoryContent(storyData) {
            storyContentContainer.innerHTML = ''; // Clear previous content
            welcomeMessage.classList.add('hidden');
            showStoryContentError(false); // Hide error message if previously shown
            storyContentContainer.classList.remove('hidden');

            const formattedTitle = formatTitle(storyData.title);
            const title = document.createElement('h1');
            title.textContent = formattedTitle;
            // Use prose classes for title styling or apply custom ones
            title.className = 'text-3xl md:text-4xl font-display font-bold text-deep-purple dark:text-warm-cream mb-6 border-b border-medium-purple dark:border-deep-purple pb-3';
            storyContentContainer.appendChild(title);

            currentStoryTitleHeader.textContent = formattedTitle; // Update header title

            // Split content by newline characters and create paragraphs
            // Filter out potentially empty lines more robustly
            const paragraphs = storyData.content.split(/[\r\n]+/).filter(p => p.trim().length > 0);
            paragraphs.forEach(paraText => {
                const p = document.createElement('p');
                 // Sanitize text content to prevent potential XSS if content could be user-generated later
                p.textContent = paraText;
                storyContentContainer.appendChild(p);
            });

             // Apply fade-in animation
             storyContentContainer.style.opacity = 1;
             storyContentContainer.classList.add('animate-fade-in');

            readingPane.scrollTop = 0; // Scroll to top of new content
        }

         // --- Text Selection & Highlighting ---

         document.addEventListener('mouseup', handleTextSelection);
         document.addEventListener('mousedown', handleClickOutsideMenu); // To close menu

         function handleTextSelection(event) {
             // Don't show menu if clicking inside it
             if (highlightMenu.contains(event.target)) return;

             const selection = window.getSelection();
             const selectedText = selection.toString().trim();

             // Only show menu if text is selected WITHIN the story content area
             if (selectedText.length > 0 && storyContentContainer.contains(selection.anchorNode)) {
                 currentSelection = selection.getRangeAt(0).cloneRange(); // Store the range
                 const rect = currentSelection.getBoundingClientRect();

                 // Get scroll offsets
                 const scrollX = readingPane.scrollLeft; // Use readingPane scroll offset
                 const scrollY = readingPane.scrollTop;

                 // Adjust coordinates relative to the reading pane
                 const readingPaneRect = readingPane.getBoundingClientRect();
                 const relativeX = rect.left - readingPaneRect.left;
                 const relativeY = rect.top - readingPaneRect.top;

                 positionMenu(relativeX + scrollX, relativeY + scrollY, rect.height);
                 highlightMenu.classList.add('visible'); // Use class for visibility and animation
             } else {
                 hideMenu();
             }
         }

        function positionMenu(x, y, height) {
            const menuHeight = highlightMenu.offsetHeight || 30; // Estimate height if not rendered yet
            const menuWidth = highlightMenu.offsetWidth || 50; // Estimate width
            const buffer = 8; // Increased buffer

            let top = y - menuHeight - buffer;
            let left = x; // Align with start of selection

            // Adjust if menu goes off-screen top relative to reading pane viewport
            if (top < readingPane.scrollTop) {
                top = y + height + buffer; // Position below selection
            }
             // Adjust horizontal position if needed (less critical usually)
             // Ensure it stays within readingPane bounds (simplified)
            left = Math.max(readingPane.scrollLeft + buffer, left);
             const maxLeft = readingPane.scrollLeft + readingPane.offsetWidth - menuWidth - buffer;
            left = Math.min(maxLeft, left);


            highlightMenu.style.left = `${left}px`;
            highlightMenu.style.top = `${top}px`;
        }


        function hideMenu() {
            highlightMenu.classList.remove('visible');
            // Use setTimeout to allow fade-out animation before hiding completely
            setTimeout(() => {
                 // Check if it's still hidden before setting display none
                 if (!highlightMenu.classList.contains('visible')) {
                    highlightMenu.style.display = 'none';
                 }
            }, 200); // Match transition duration
            currentSelection = null;
        }

        function handleClickOutsideMenu(event) {
             // Only hide if the menu is visible and the click is outside BOTH the menu and the current selection
            if (highlightMenu.classList.contains('visible') && !highlightMenu.contains(event.target)) {
                 const selection = window.getSelection();
                  // Check if click is outside the selection range
                  // This is tricky, a simpler check is often good enough:
                  // If the click target is NOT within the highlightMenu, hide it.
                 // The mouseup handler will re-show it if a new selection is made.
                 hideMenu();
            }
        }


        highlightButton.addEventListener('click', (e) => {
             e.stopPropagation(); // Prevent click from closing menu immediately
             if (currentSelection) {
                 applyHighlight(currentSelection);
                 hideMenu();
             }
         });

        function applyHighlight(range) {
            // Standard, robust way using spans
            try {
                const span = document.createElement('span');
                span.className = 'highlight';
                // Surround contents safely handles partial nodes
                range.surroundContents(span);

                // Clear the browser's visual selection after highlighting
                window.getSelection().removeAllRanges();
            } catch (e) {
                console.error("Error applying highlight (likely spans across block elements):", e);
                 // Fallback using execCommand (less ideal, deprecated, might not work everywhere)
                 try {
                     // Need to re-select the range for execCommand
                     window.getSelection().removeAllRanges();
                     window.getSelection().addRange(range);
                     // Determine highlight color based on theme - simplified
                     const highlightColor = document.documentElement.classList.contains('dark') ? '#A092D8' : '#FFF3C4';
                     document.execCommand('backColor', false, highlightColor);
                     window.getSelection().removeAllRanges(); // Clear selection again
                 } catch (execError) {
                      console.error("execCommand fallback also failed:", execError);
                 }
            }
         }


        // --- Event Listeners ---
        retryLoadStoriesBtn.addEventListener('click', fetchStoryList);
         retryLoadContentBtn.addEventListener('click', () => {
             if(lastLoadedStoryId) {
                 fetchStoryContent(lastLoadedStoryId);
             }
         });

        // --- Theme Toggle Script ---
        const themeToggleButton = document.getElementById('theme-toggle');
        const darkIcon = document.getElementById('theme-toggle-dark-icon');
        const lightIcon = document.getElementById('theme-toggle-light-icon');
        const setTheme = (isDark) => {
            if (isDark) {
                document.documentElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
                if (lightIcon && darkIcon) {
                     lightIcon.classList.remove('hidden');
                    darkIcon.classList.add('hidden');
                }
            } else {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
                 if (lightIcon && darkIcon) {
                    darkIcon.classList.remove('hidden');
                    lightIcon.classList.add('hidden');
                }
            }
        };
        // Set initial theme and icon state
        const isCurrentlyDark = document.documentElement.classList.contains('dark');
        setTheme(isCurrentlyDark);

        if(themeToggleButton) {
            themeToggleButton.addEventListener('click', () => {
                setTheme(!document.documentElement.classList.contains('dark'));
            });
        }

        // --- Initial Load ---
        document.addEventListener('DOMContentLoaded', fetchStoryList);

    </script>

</body>
</html>

